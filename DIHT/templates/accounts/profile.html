{% extends "base.html" %}
{% load static from staticfiles %}
{% block title %} Личный кабинет {% endblock %}
{% block main_active %} class = "active" {% endblock %}
{% block custom_scripts %}<script src="{% static 'js/profile.js' %}"></script>{% endblock %}
{% block content %}
    <div class="page-header">
        <h1>Личный кабинет</h1>
    </div>
    <div class="row">
        <div class="col-md-offset-1 col-md-4"><div class = "well" align="center"><img class = "round avatar" src="/static/img/standart_avatar.png"></img></div></div>
        <div class="col-md-6"><div class = "well">
            <h2>{{ profile_user.first_name }} {{ profile_user.last_name }} ({{ profile_user.username }})</h2>
            {% if profile_user.groups.all %}
            <h4>Группы:
                {% for group in profile_user.groups.all %}
                {{ group }};
                {% endfor %}
            </h4>
            {% endif %}
        </div></div>
    </div>
    <div class="row">
        <div class = "tabs">
            <ul class = "nav nav-tabs">
                <li class = "active"><a href="#tab-acc" data-toggle="tab">Аккаунт</a></li>
                {% if profile.user == request.user %}
                <li><a href="#tab-tsk" data-toggle="tab">Задачи</a></li>
                {% endif %}
                <li><a href="#tab-ach" data-toggle="tab">Достижения</a></li>
                {% if profile.user == request.user %}
                <li><a href="#tab-wsh" data-toggle="tab">Стиралка</a></li>
                {% endif %}
            </ul>
            <div class = "tab-content">
                <div class = "tab-pane active" id = "tab-acc">
                    <p><b>Группа:</b> {{ profile.group_number }}</p>
                    <p><b>Общежитие:</b> {{ profile.hostel }}</p>
                    <p><b>Комната:</b> {{ profile.room_number }}</p>
                    <p><b>Телефон:</b> {{ profile.mobile }} </p>
                    {% if profile.user == request.user %}
                    <p><b>Добавить соц. сеть:</b>
                        <a href="{% url 'accounts:social:begin' 'facebook' %}"><img src="/static/img/facebook.png" style="height:40px;width:40px"></a>
                        <a href="{% url 'accounts:social:begin' 'vk-oauth2' %}"><img src="/static/img/vk.png" style="height:40px;width:40px"></a>
                    </p>
                    <button class = "btn btn-primary"
                            href="{% url 'accounts:edit_profile' id=profile.id %}"
                            data-toggle="modal"
                            data-target="#form-modal">Изменить</button>
                    {% endif %}
                </div>
                {% if profile.user == request.user %}
                <div class = "tab-pane" id = "tab-tsk">
                    <p><b>Созданные задачи:</b></p>
                    <ul>
                    {% for task in profile_user.tasks_created.all %}
                        <li><a href="{% url 'activism:task' id=task.id %}"> {{ task.name }} </a></li>
                    {% endfor %}
                    </ul>
                    <p><b>Задачи, на которые подана заявка:</b></p>
                    <ul>
                    {% for task in profile_user.tasks_approve.all %}
                        <li><a href="{% url 'activism:task' id=task.id %}"> {{ task.name }} </a></li>
                    {% endfor %}
                    </ul>
                    <p><b>Текущие задачи:</b></p>
                    <ul>
                    {% for task in profile_user.tasks.all %}
                        <li><a href="{% url 'activism:task' id=task.id %}"> {{ task.name }} </a></li>
                    {% endfor %}
                    </ul>
                </div>
                {% endif %}
                <div class = "tab-pane" id = "tab-ach">
                </div>
                {% if profile.user == request.user %}
                <div class = "tab-pane" id = "tab-wsh">
                    <p><b>Записи:</b></p>
                    {% for record in records %}
                        <p>{{ record.machine.name }}, {{ record.datetime_from.date }}, с {{ record.datetime_from.time }} до {{ record.datetime_to.time }} </p>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </div>
    </div>
{% include "modal.html" %}
{% endblock %}